# Игра "Жизнь" в 2D- и 3D-режимах
## Навигация по проекту
### Код
> /game life code/Assets/Scripts
### Для скачивания игры
> /GameLife
## Описание программы

### Основные сведения
Игра «Жизнь» - это клеточный автомат, который был придуман математиком Джоном Конвеем в 1970 году. Она представляет собой модель развития популяции клеток на двумерной поверхности.
Каждая клетка может находиться в одном из двух состояний: живой или мертвой. В зависимости от состояния соседних клеток, клетка может изменить свое состояние на следующем шаге.

В классическую версию этой игры была добавлена возможность переключения между двумерным и трехмерным режимами.
В трехмерном режиме игрок может наблюдать за развитием популяции клеток в трехмерном пространстве.

### Типы клеток
Правила были изменены таким образом, что каждая клетка может находиться в одном из пяти состояний: пустой, обычной клетки, паразита, гриба или стволовой клетки.
В зависимости от состояния соседних клеток, клетка может изменить свое состояние на следующем шаге.

Вышеперечисленные типы клеток рождаются и выживают по заданным игроком правилам. Если присвоить всем типам клеток номера по следующему принципу: 
*пустая* — 0, *обычная* — 1, *паразит* — 2, *гриб* — 3, *стволовая* — 4, — то соседи для проверки условий рождения и выживания клеток считаются следующим образом:
- для обычной клетки: (1)-(2)+(4)
- для паразита: (1)+(3)+(4)
- для гриба: (0)+(3)
- для стволовой клетки: (1)+(2)+(3)+(4)

У типов клеток (2), (3), (4) есть свои особенности, отличающие их от других. Например, (2) отнимает единицу из списка соседей клеток (1) рядом с ней, 
так как это паразит, отнимающий питательные вещества у обычных клеток. Помимо этого (2) — единственный тип клетки, который не появляется на пустом месте, 
а мутирует из клетки типа (1). (3) рождается и выживает в свободных условиях, то есть, если рядом определенное количество пустых клеток и клеток грибов. 
Самая необычная клетка — клетка (4), так как эта клетка, будучи неспособной выжить, может превратиться в другую клетку, чтобы продолжить существовать на поле.

### Возможности игрока
Игрок может:
- влиять на развитие популяции, изменяя начальное расположение клеток и правила, по которым клетки рождаются и выживают и наблюдая за тем, как они взаимодействуют друг с другом.
- изменять в настройках размер поля, скорость симуляции и ограниченность поля.
> Если поле ограничено, то симуляция происходит в замкнутом поле в форме прямоугольника или параллелепипеда. При этом у клеток, находящихся возле стены, максимальное количество соседей
меньше, чем у других. В противном случае клетка у стены считает своим соседом каждую клетку возле противоположной стены, если клетки этих типов могут взаимодействовать.
- изменять скорость симуляции в настройках или в процессе игры.
- сохранять состояние поля и правила и загружать сохраненную информацию.
- использовать зум на 2д-поле и двигаться вдоль поля
- рисовать на двумерном поле.
- создать срез трехмерного поля по определенной координате и вставить двумерное поле в качестве среза внутрь трехмерного.

### Общие технические сведения
Была создана иконка приложения, позволяющая отличить его от других и отражающая его суть.

Проект выполнен на базе движка Unity с использованием языка С#.

Сам игровой процесс происходит следующим образом: создается копия массива, хранящего информацию о состоянии поля. Во избежание ошибок, связанных с последовательностью обработки клеток на поле, 
каждая клетка ищет соседей в старом массиве, а записывает свое новое состояние в новый массив. Подсчет количества соседей зависит от типа клетки. Принцип подсчета соседей для каждого типа клеток 
уже был описан выше.

### Сохранение
Сохранение состояния поля и настроек происходит так: сначала создаются сериализуемые классы, один из которых содержит информацию о поле, а другой содержит информацию о настройках, в том числе еще 
четыре класса, каждый из которых хранит информацию о настройках для одного из типов клеток. Далее сериализуемые классы помещаются в *JSON*-файл. Таким образом, этот файл хранит всю необходимую 
информацию для восстановления состояния поля и настроек игры. Далее перезаписывается картинка, на которой изображено игровое поле. Также эта картинка сразу устанавливается в соответствующий слот сохранения.

Для каждого из режимов игры, 2D и 3D, существует четыре таких слота, с которыми можно взаимодействовать из главного меню без возможности сохранения или нажав специальную кнопку. В последнем случае игру 
можно как загрузить, так и сохранить.

При загрузке игры *JSON*-файл сериализуется и преобразуется обратно в экземпляры классов, содержащих всю информацию об игре. Далее применяются все указанные настройки и производится проверка на соответствие 
и замена каждой клетки поля. При этом все поле приобретает состояние, указанное в JSON-файле.

### Взаимодействие 2D и 3D
Переход от 3D- к 2D-режиму осуществляется несколькими способами:
- создание среза
> В этом случае пользователь выбирает ось и координату для среза, после чего создается новая текстура, представляющая двумерный срез трехмерного поля по данной координате и являющаяся готовым к запуску игры 
полем.
- возврат к предыдущему состоянию поля.
> В данном случае поле запускается в том состоянии, в котором оно было при последнем изменении пользователем. Если же пользователь еще не запускал 2D-поле, то создастся пустое поле размером 10*10 клеток.

### Особенности 2D-поля
Если выбран 2D-режим, то клетки представляют собой не объекты как в 3D-режиме, а пиксели на двумерном поле-текстуре. Приближение и движение вдоль поля при этом на самом деле меняют размер и положение 
всего холста, который ограничен маской для стабильного положения на экране. Такой способ работы с двумерным полем облегчает сохранение игры, так как картинка, прикрепляемая к сохраненной игре, 
представляет собой само поле, чего нельзя сказать о трехмерном поле, где эта картинка рендерится через отдельную предназначенную для этого камеру. Эти картинки нужны для того, чтобы отличить 
сохраненные поля друг от друга, не загружая их для этого.

В 2D-режиме можно вставить двумерное поле внутрь трехмерного.

Выбор типа клетки в 2D-режиме представляет собой выбор одного из цветов палитры, каждый из которых соответствует одному из типов клетки.

Создание новых клеток производится через отслеживание точки текстуры, на которую наведен курсор. Если нажата левая кнопка мыши, то в этой точке пиксель изменяет цвет на выбранный пользователем, 
а значение ID клетки в массиве, соответствующей данной точке, изменяется на ID, соответствующий данному цвету.

### Особенности 3D-поля
В 3D-режиме помимо послойного рисования есть два режима создания новых клеток. При создании клетки с помощью одного из этих способов в истории изменения клеток поля появляется соответствующая запись. 

Первый способ долгий, но точный: пользователь должен вручную задать координаты клетки, которую он хочет изменить, и новый тип клетки.

Второй тип больше похож на взаимодействие с двумерным полем. Строится луч из камеры через позицию курсора. Клетка создается в том случае, если луч сталкивается с непустой клеткой поля. Пользователь 
выбирает тип клетки, которую хочет создать. Далее нужно нажать ctrl и левую кнопку мыши. Если тип клетки, в которую врезался луч, не совпадает с типом, выбранным пользователем, то эта клетка заменяется 
на выбранную. Если же типы совпадают, то отслеживается, в какую из шести граней врезался луч, после чего создается новая клетка таким образом, чтобы она касалась этой грани своей гранью.

Если нажать клавишу «E» при редактировании 3D-поля, будет активирован режим, в котором отсутствует большая часть интерфейса, что увеличивает обзор, и появится возможность двигать и вращать камеру. 
Этот режим будет активен, пока снова не будет нажата та же кнопка.
